"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[270],{90352:(e,t,n)=>{n.d(t,{n:()=>se});var a=n(67294),r=n(50114),o=n(17213),l=n(69559),i=n(4236),s=n(13218),c=n(70296),m=n(67154),u=n.n(m),d=n(69518),f=n.n(d),g=n(62031),E=n(49058),h=n(5843),y=n(97605),p=n(20657),v=n(18261),_=n(4232),T=n(80507),I=n(25988),b=n(35410),P=n(86514),S=n(94184),w=n.n(S),k=n(52883),A=n(28760),C=n(43864),N=n(85592),B=n(34325),L=n(84242),M=n(1496),R=n(99191),F=n(56802),O=n(67892),U=n(80418),x=n(49961);const H="view-homeShortcutsGrid-shortcuts",W="view-homeShortcutsGrid-grid",D="view-homeShortcutsGrid-shortcutLink",z="view-homeShortcutsGrid-shortcut",G="view-homeShortcutsGrid-draggable",$="view-homeShortcutsGrid-imageContainer",Y="view-homeShortcutsGrid-imageWrapper",q="view-homeShortcutsGrid-image",J="CKxS_0I5yf3i15WAjzvE",Z="view-homeShortcutsGrid-main",X="EzRmGRncgnv1zFgF4dqE",K="bPmmKmSPLKMhtJSaUJRX",V="view-homeShortcutsGrid-PlayButtonContainer",j="s9c9x_mJq197U2hBzGtV",Q=a.memo((({images:e=[],fallbackIcon:t=g.U})=>{const n=(0,x.X)(e),r=null!=n&&n.url?Y:J;return a.createElement("div",{className:$},a.createElement("div",{className:r},a.createElement(U.E,{className:q,src:null==n?void 0:n.url,loading:"lazy",testid:"shortcut-image"},a.createElement(t,{"aria-hidden":!0}))))})),ee=a.memo((({index:e,item:t,fallbackIcon:n,showPlayButton:r,onContextMenu:o=(()=>{}),onTouchStart:l=(()=>{}),onTouchEnd:i=(()=>{})})=>{var s,m;const u=(0,k.k6)(),d=(0,F.o)(),{setColorFromUri:g,resetColor:E,clearColor:h}=(0,c.WQ)(),y=(0,B.G3)(t.uri,t.release_date,null===(s=t.resume_point)||void 0===s?void 0:s.resume_position_ms,null===(m=t.resume_point)||void 0===m?void 0:m.fully_played),{spec:p,logger:v}=(0,M.fU)(C.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:_,isActive:T,togglePlay:I}=(0,L.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"});const b=(0,a.useCallback)((()=>{d({targetUri:t.uri,intent:"navigate",type:"click"});const e=p.hitUiNavigate({destination:t.uri});v.logInteraction(e),u.push(f().from(t.uri).toURLPath(!0))}),[u,t.uri,v,d,p]),P=(0,a.useCallback)((()=>{g(t.uri)}),[t.uri,g]);(0,a.useEffect)((()=>()=>{h()}),[h]);const S=(0,M.Wi)(p),U=(0,R.O1)([t.uri],t.name);return a.createElement("div",{ref:S,className:z,onContextMenu:o,onTouchStart:l,onTouchEnd:i,onMouseEnter:P,onMouseLeave:E},a.createElement("div",{className:G,onDragStart:U},a.createElement(Q,{images:t.images,fallbackIcon:n}),a.createElement("div",{className:Z},a.createElement(O.r,{to:t.uri,onClick:b,title:t.name},a.createElement(A.Dy,{as:"p",variant:"balladBold",className:X},t.name)),y&&a.createElement(B.Rd,{className:K}),r&&a.createElement("div",{className:w()(V,{[j]:_})},a.createElement(N.fh,{isPlaying:_,onClick:function(){d({targetUri:t.uri,intent:_?"pause":"play",type:"click"});const e=p.playButtonFactory();let n;n=_?e.hitPause({itemToBePaused:t.uri}):T?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri});const a=v.logInteraction(n);I({loggingParams:a})}}))),a.createElement("div",{onClick:b,className:D})))})),te=a.memo((e=>f().isCollection(e.item.uri)?a.createElement(ee,u()({},e,{fallbackIcon:g.U})):a.createElement(v._,{menu:a.createElement(b.X,{uri:e.item.uri})},a.createElement(ee,u()({},e,{fallbackIcon:g.U}))))),ne=a.memo((e=>a.createElement(v._,{menu:a.createElement(_.Y,{uri:e.item.uri})},a.createElement(ee,u()({},e,{fallbackIcon:E.c}))))),ae=a.memo((e=>a.createElement(v._,{menu:a.createElement(T.m,{uri:e.item.uri})},a.createElement(ee,u()({},e,{fallbackIcon:h.a}))))),re=a.memo((e=>a.createElement(v._,{menu:a.createElement(P.M,{uri:e.item.uri})},a.createElement(ee,u()({},e,{fallbackIcon:y.J,showPlayButton:!1}))))),oe=a.memo((e=>a.createElement(v._,{menu:a.createElement(I.k,{uri:e.item.uri})},a.createElement(ee,u()({},e,{fallbackIcon:y.J,showPlayButton:!1})))));const le=270,ie=a.memo((({title:e,tagline:t,items:n})=>{const{fetchMultipleColors:r}=(0,c.WQ)(),[o,m]=(0,a.useState)({minWidth:le,itemHeight:80,showPlayButton:!0}),u=!(0,i.k)(),d=(0,a.useRef)(null),g=null!=e?e:(()=>{const e=(new Date).getHours();let t=p.ag.get("home.evening");return e>=5&&e<12?t=p.ag.get("home.morning"):e>=12&&e<18&&(t=p.ag.get("home.afternoon")),t})(),E=(0,a.useCallback)((()=>{if(!d.current)return;const e=d.current.offsetWidth,t=e<600?200:le;const n=Math.min(Math.floor((e+24)/(t+24)),3);m({minWidth:t,showPlayButton:(e-24*(n-1))/n>=le,itemHeight:e>=858?80:64})}),[]);if((0,l.a)((()=>{E()})),(0,a.useEffect)((()=>{E()}),[E]),(0,a.useEffect)((()=>{const e=(null==n?void 0:n.map(c.lh))||[];r(e)}),[n,r]),u||null==n||!n.length)return null;const h=64===o.itemHeight?12:16;return a.createElement("section",{className:H,"aria-label":g,ref:d},a.createElement(s.r,{title:g,titleVariant:"alto",tagline:t}),a.createElement("div",{className:W,style:{"--min-column-width":`${o.minWidth}px`,"--column-gap":"24px","--row-gap":`${h}px`,"--item-height":`${o.itemHeight}px`}},n.filter(((e,t)=>t<6)).map(((e,t)=>{const n=function(e){const t=(f().from(e)||{}).type;switch(t){case f().Type.ARTIST:return ae;case f().Type.ALBUM:case f().Type.COLLECTION_ALBUM:return ne;case f().Type.PLAYLIST:case f().Type.PLAYLIST_V2:return te;case f().Type.SHOW:return re;case f().Type.EPISODE:return oe;case f().Type.COLLECTION:return te;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),re}}(e.uri);return a.createElement(n,{index:t,key:`${t}-${e.uri}`,item:e,showPlayButton:o.showPlayButton,shouldSetBackgroundColor:0===t})}))))})),se=(0,r.P)(ie,(()=>null),(e=>(0,o.v)({from:"HomeShortcutsGrid",error:e})))},71121:(e,t,n)=>{n.r(t),n.d(t,{HOME_REFRESH_TIMEOUT:()=>B,default:()=>L});var a=n(67294),r=n(94184),o=n.n(r),l=n(46458),i=n(73526),s=n(20657),c=n(70369),m=n(90352),u=n(1663),d=n(86964),f=n(35533),g=n(87577),E=n(26529),h=n(33607),y=n(23716),p=n(74845),v=n(8247),_=n(8271);const T="PLAY_AT_FIRST_TAP_HAD_DEFERRED_ACTIONS";function I(e){const t=(0,g.W6)(v.Qs),[n,r]=(0,a.useState)(void 0),[o,i]=(0,a.useState)(void 0),[s,c]=(0,a.useState)(!1),m=(0,y.g)(),u=(0,l.v9)((({session:e})=>e.user&&e.user.id)),d=(0,_.s4)(),I=(0,a.useCallback)((function(e){const t=(0,f.x)(e);d.send(t)}),[d]);(0,a.useEffect)((()=>{i(!!window.sessionStorage.getItem(T)&&(window.sessionStorage.removeItem(T),!0))}),[]),(0,a.useEffect)((()=>{u&&(I({category:"play-at-first-tap",label:"log_attempt",os:(0,h.y)(),context:"ab_v3"}),c((e=>!!window.sessionStorage.getItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`))(u)),(0,p.M)(E.b.getInstance()).then((e=>{r(e.content.items.length>0)})).catch((()=>{I({category:"play-at-first-tap",label:"recently-played-failed",os:(0,h.y)(),context:"ab_v3"}),r(!0)})))}),[u,I]),(0,a.useEffect)((()=>{if(void 0===n||void 0===o||!e||!u||s)return;const a=!n&&!o;if(a){(e=>{window.sessionStorage.setItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`,JSON.stringify(!0))})(u);const n=(e=>{const t=e.content.items.find((e=>{const t="CAROUSEL"===e.rendering,n="LIST"===e.rendering&&"shortcuts"!==e.id;return t||n}));if(!t)return;const n=t.content.items.find((e=>!e.publisher||!e.publisher.startsWith("Spotify")));return n&&n.uri})(e);n&&t&&m.play({uri:n},{featureIdentifier:"home",referrerIdentifier:"home"},{paused:!0}),I({category:"play-at-first-tap",label:"play_content",os:(0,h.y)(),context:n||"no_valid_uri_retrieved"})}I({category:"play-state",label:a?"has_valid_state_yes":"has_valid_state_no",os:(0,h.y)(),context:"ab_v3"})}),[s,n,e,o,m,u,t,I])}var b=n(13983),P=n(29255),S=n(42922),w=n(1496),k=n(23809),A=n(23060),C=n(29393),N=n(16896);const B=18e5,L=a.memo((()=>{const{isAnonymous:e}=(0,l.v9)(P.Gg),t=(0,C.v8)(e),{view:n}=(0,k.P)(t,{cacheTime:B}),{spec:r,UBIFragment:f}=(0,w.fU)(i.createDesktopHomeEventFactory,{data:{identifier:t,uri:"spotify:home"}});(0,b.z)("home"),I(n);const g=null==n?void 0:n.content.items,[E,h]=(0,a.useMemo)((()=>{const e=[];let t=null;if(Array.isArray(g))for(let n=0;n<g.length;n++){const a=g[n];"shortcuts"===a.id?t=a:e.push(a)}return[t,e]}),[g]);return a.createElement(f,{spec:r},a.createElement(c.$,null,s.ag.get("page.generic-title")),a.createElement(a.Suspense,{fallback:null},a.createElement(A.S,null)),n?a.createElement("section",{"data-testid":"home-page"},a.createElement("div",{className:N.Z.home},a.createElement("div",{className:o()(N.Z.content,"contentSpacing")},E?a.createElement(f,{spec:r.shortcutsFactory()},a.createElement(S.JL,{value:"headered-grid",key:E.id},a.createElement(m.n,{items:E.content.items,title:E.name,tagline:E.tag_line}))):null,a.createElement(f,{spec:r.shelvesFactory()},a.createElement(d.c,{spaces:h,viewName:n.name,viewId:t,isAnonymous:e}))))):a.createElement(u.h,{hasError:!1,errorMessage:s.ag.get("error.not_found.title.page")}))}))},23060:(e,t,n)=>{n.d(t,{S:()=>s});var a=n(67294),r=n(87577),o=n(49207),l=n(28638),i=n(47402);const s=()=>(0,r.W6)(o.Jw)===o.pF.ONHOME?a.createElement(l.w,null,a.createElement(i.M,{onSearch:!1})):null}}]);
//# sourceMappingURL=home-v1.js.map